# æ“ä½œç¯å¢ƒå˜é‡

https://sysin.org/blog/windows-env/
cmdä¸­ä½¿ç”¨`%CD%`è®¿é—®ç¯å¢ƒå˜é‡ï¼Œpowershellä½¿ç”¨`$env:windir`
ä¸´æ—¶è®¾ç½®ç¯å¢ƒå˜é‡`set å˜é‡å=``

## å¸¸ç”¨ç¯å¢ƒå˜é‡

```sh
%ALLUSERSPROFILE% å±€éƒ¨ è¿”å›æ‰€æœ‰â€œç”¨æˆ·é…ç½®æ–‡ä»¶â€çš„ä½ç½®ã€‚  
%APPDATA% å±€éƒ¨ è¿”å›é»˜è®¤æƒ…å†µä¸‹åº”ç”¨ç¨‹åºå­˜å‚¨æ•°æ®çš„ä½ç½®ã€‚  
%CD% å±€éƒ¨ è¿”å›å½“å‰ç›®å½•å­—ç¬¦ä¸²ã€‚  
%CMDCMDLINE% å±€éƒ¨ è¿”å›ç”¨æ¥å¯åŠ¨å½“å‰çš„ Cmd.exe çš„å‡†ç¡®å‘½ä»¤è¡Œã€‚  
%CMDEXTVERSION% ç³»ç»Ÿ è¿”å›å½“å‰çš„â€œå‘½ä»¤å¤„ç†ç¨‹åºæ‰©å±•â€çš„ç‰ˆæœ¬å·ã€‚  
%COMPUTERNAME% ç³»ç»Ÿ è¿”å›è®¡ç®—æœºçš„åç§°ã€‚  
%COMSPEC% ç³»ç»Ÿ è¿”å›å‘½ä»¤è¡Œè§£é‡Šå™¨å¯æ‰§è¡Œç¨‹åºçš„å‡†ç¡®è·¯å¾„ã€‚  
%DATE% ç³»ç»Ÿ è¿”å›å½“å‰æ—¥æœŸã€‚ä½¿ç”¨ä¸ date /t å‘½ä»¤ç›¸åŒçš„æ ¼å¼ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚æœ‰å…³ date å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… Dateã€‚  
%ERRORLEVEL% ç³»ç»Ÿ è¿”å›æœ€è¿‘ä½¿ç”¨è¿‡çš„å‘½ä»¤çš„é”™è¯¯ä»£ç ã€‚é€šå¸¸ç”¨éé›¶å€¼è¡¨ç¤ºé”™è¯¯ã€‚  
%HOMEDRIVE% ç³»ç»Ÿ è¿”å›è¿æ¥åˆ°ç”¨æˆ·ä¸»ç›®å½•çš„æœ¬åœ°å·¥ä½œç«™é©±åŠ¨å™¨å·ã€‚åŸºäºä¸»ç›®å½•å€¼çš„è®¾ç½®ã€‚ç”¨æˆ·ä¸»ç›®å½•æ˜¯åœ¨â€œæœ¬åœ°ç”¨æˆ·å’Œç»„â€ä¸­æŒ‡å®šçš„ã€‚  
%HOMEPATH% ç³»ç»Ÿ è¿”å›ç”¨æˆ·ä¸»ç›®å½•çš„å®Œæ•´è·¯å¾„ã€‚åŸºäºä¸»ç›®å½•å€¼çš„è®¾ç½®ã€‚ç”¨æˆ·ä¸»ç›®å½•æ˜¯åœ¨â€œæœ¬åœ°ç”¨æˆ·å’Œç»„â€ä¸­æŒ‡å®šçš„ã€‚  
%HOMESHARE% ç³»ç»Ÿ è¿”å›ç”¨æˆ·çš„å…±äº«ä¸»ç›®å½•çš„ç½‘ç»œè·¯å¾„ã€‚åŸºäºä¸»ç›®å½•å€¼çš„è®¾ç½®ã€‚ç”¨æˆ·ä¸»ç›®å½•æ˜¯åœ¨â€œæœ¬åœ°ç”¨æˆ·å’Œç»„â€ä¸­æŒ‡å®šçš„ã€‚  
%LOGONSEVER% å±€éƒ¨ è¿”å›éªŒè¯å½“å‰ç™»å½•ä¼šè¯çš„åŸŸæ§åˆ¶å™¨çš„åç§°ã€‚  
%NUMBER_OF_PROCESSORS% ç³»ç»Ÿ æŒ‡å®šå®‰è£…åœ¨è®¡ç®—æœºä¸Šçš„å¤„ç†å™¨çš„æ•°ç›®ã€‚  
%OS% ç³»ç»Ÿ è¿”å›æ“ä½œç³»ç»Ÿçš„åç§°ã€‚Windows 2000 å°†æ“ä½œç³»ç»Ÿæ˜¾ç¤ºä¸º Windows_NTã€‚  
%PATH% ç³»ç»Ÿ æŒ‡å®šå¯æ‰§è¡Œæ–‡ä»¶çš„æœç´¢è·¯å¾„ (sysin)ã€‚  
%PATHEXT% ç³»ç»Ÿ è¿”å›æ“ä½œç³»ç»Ÿè®¤ä¸ºå¯æ‰§è¡Œçš„æ–‡ä»¶æ‰©å±•åçš„åˆ—è¡¨ã€‚  
%PROCESSOR_ARCHITECTURE% ç³»ç»Ÿ è¿”å›å¤„ç†å™¨çš„èŠ¯ç‰‡ä½“ç³»ç»“æ„ã€‚å€¼: x86ï¼ŒIA64ã€‚  
%PROCESSOR_IDENTFIER% ç³»ç»Ÿ è¿”å›å¤„ç†å™¨è¯´æ˜ã€‚  
%PROCESSOR_LEVEL% ç³»ç»Ÿ è¿”å›è®¡ç®—æœºä¸Šå®‰è£…çš„å¤„ç†å™¨çš„å‹å·ã€‚  
%PROCESSOR_REVISION% ç³»ç»Ÿ è¿”å›å¤„ç†å™¨ä¿®è®¢å·çš„ç³»ç»Ÿå˜é‡ã€‚  
%PROMPT% å±€éƒ¨ è¿”å›å½“å‰è§£é‡Šç¨‹åºçš„å‘½ä»¤æç¤ºç¬¦è®¾ç½®ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚  
%RANDOM% ç³»ç»Ÿ è¿”å› 0 åˆ° 32767 ä¹‹é—´çš„ä»»æ„åè¿›åˆ¶æ•°å­—ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚  
%SYSTEMDRIVE% ç³»ç»Ÿ è¿”å›åŒ…å« Windows XP æ ¹ç›®å½•ï¼ˆå³ç³»ç»Ÿæ ¹ç›®å½•ï¼‰çš„é©±åŠ¨å™¨ã€‚  
%SYSTEMROOT% ç³»ç»Ÿ è¿”å› Windows XP æ ¹ç›®å½•çš„ä½ç½®ã€‚  
%TEMP% and %TMP% ç³»ç»Ÿå’Œç”¨æˆ· è¿”å›å¯¹å½“å‰ç™»å½•ç”¨æˆ·å¯ç”¨çš„åº”ç”¨ç¨‹åºæ‰€ä½¿ç”¨çš„é»˜è®¤ä¸´æ—¶ç›®å½•ã€‚æœ‰äº›åº”ç”¨ç¨‹åºéœ€è¦ TEMPï¼Œè€Œå…¶å®ƒåº”ç”¨ç¨‹åºåˆ™éœ€è¦ TMPã€‚  
%TIME% ç³»ç»Ÿ è¿”å›å½“å‰æ—¶é—´ã€‚ä½¿ç”¨ä¸ time /t å‘½ä»¤ç›¸åŒçš„æ ¼å¼ã€‚ç”± Cmd.exe ç”Ÿæˆã€‚æœ‰å…³ time å‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… Timeã€‚  
%USERDOMAIN% å±€éƒ¨ è¿”å›åŒ…å«ç”¨æˆ·å¸æˆ·çš„åŸŸçš„åç§°ã€‚  
%USERNAME% å±€éƒ¨ è¿”å›å½“å‰ç™»å½•çš„ç”¨æˆ·çš„åç§°ã€‚  
%UserProfile% å±€éƒ¨ è¿”å›å½“å‰ç”¨æˆ·çš„é…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚  
%WINDIR% ç³»ç»Ÿ è¿”å›æ“ä½œç³»ç»Ÿç›®å½•çš„ä½ç½®ã€‚
```

# Powershellåœ¨çº¿æ•™ç¨‹

https://www.pstips.net/powershell-online-tutorials#Powershell%E7%AE%A1%E9%81%93

# Powershell å¸¸ç”¨å‘½ä»¤

https://juejin.cn/post/6854573219232350221

##### è®¾ç½®å˜é‡

```bash
PS D:\> $a = 5
PS D:\> $a * 4
20
PS D:\> "sdf".substring(2)
f
PS D:\> $str = "powershell"
PS D:\> $str.substring($str.indexOf("s"))
shell
```

powershellæ”¯æŒ.netçš„æ–¹æ³•ï¼šæˆªå–å­—ç¬¦ä¸²ã€ifè¯­å¥åˆ¤æ–­ç­‰è¿™äº›éƒ½æ²¡æœ‰é—®é¢˜ã€‚å¯ä»¥æ ¹æ®è‡ªå·±éœ€è¦æ¥å»ä½¿ç”¨ã€‚

å¸¸ç”¨çš„å˜é‡çŸ¥è¯†å¤§æ¦‚è¿™ä¹ˆå¤šï¼Œå…¶å®ƒæ›´å¤šå˜é‡çŸ¥è¯†å¯ä»¥å‚è€ƒ[Powershell å®šä¹‰å˜é‡](https://link.juejin.cn/?target=https%3A%2F%2Fwww.pstips.net%2Fpowershell-define-variable.html "https://www.pstips.net/powershell-define-variable.html")ã€‚

#### PowerShellå¸¸ç”¨å‘½ä»¤

##### Start-Processï¼Œåˆ«åï¼šstart + è·¯å¾„ï¼Œ æ‰“å¼€å½“å‰æ–‡ä»¶å¤¹

```bash
# æŠŠè·¯å¾„å­˜å‚¨ä¸ºå˜é‡ï¼Œæ‰“å¼€è·¯å¾„åœ°å€çš„æ–‡ä»¶
PS D:\> $variable = "D:\"
PS D:\> start $variable

# ä»¥ç®¡ç†å‘˜èº«ä»½å¯åŠ¨Powershell
PS D:\> start -FilePath "powershell" -Verb RunAs
å¤åˆ¶ä»£ç 
```

##### Get-ChildItemï¼Œåˆ«åï¼šlsã€dir, åˆ—å‡ºæ–‡ä»¶å¤¹ä¸‹æ‰€æœ‰æ–‡ä»¶

```lua
PS D:\> ls


    ç›®å½•: D:\


Mode                LastWriteTime         Length Name
----                -------------         ------ ----
d-----        2020/1/20     11:58                Downloads
...
å¤åˆ¶ä»£ç 
```

##### ğŸ‰Get-Historyï¼Œåˆ«åï¼šhistoryã€hï¼Œåˆ—å‡ºä¹‹å‰çš„æ“ä½œå‘½ä»¤

```sql
PS D:\> history

  Id CommandLine
  -- -----------
   1 Start D:
   2 Start D
   3 ${"I"like $}="test"
   ...
å¤åˆ¶ä»£ç 
```

##### ğŸ‰Get-Processï¼Œ åˆ«åï¼špsï¼ŒæŸ¥æ‰¾è¿›ç¨‹, å¯ä»¥é€šè¿‡è¿›ç¨‹åç§°æˆ–è€…è¿›ç¨‹IDæ¥è·å–ç‰¹å®šè¿›ç¨‹

```scss
 âœ  ~  ps wechat

Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName
-------  ------    -----      -----     ------     --  -- -----------
   1255      81   153952     183020     220.53   5832   2 WeChat
å¤åˆ¶ä»£ç 
```

##### new-itemï¼Œåˆ«åï¼šni <filename.txt>, åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡æœ¬æ–‡ä»¶

```diff
PS D:\> ni test.txt
    ç›®å½•: D:\
Mode                LastWriteTime         Length Name
----                -------------         ------ ----
-a----        2020/7/25     16:29              0 test.txt
å¤åˆ¶ä»£ç 
```

##### remove-itemï¼Œåˆ«åï¼š rmã€del, åˆ é™¤æˆ–åˆ é™¤æ–‡ä»¶

```bash
PS D:\> rm test.txt
å¤åˆ¶ä»£ç 
```

##### copy-itemï¼Œåˆ«åï¼šcp,\copy, å¤åˆ¶æ–‡ä»¶

```bash
PS D:\> cp test.txt test1.txt
å¤åˆ¶ä»£ç 
```

##### get-locationï¼Œåˆ«åï¼špwd, å½“å‰ç›®å½•ä½ç½®

```markdown
PS D:\> pwd
Path
----
D:\
å¤åˆ¶ä»£ç 
```

##### ğŸ‰GET-HELP, ç¼©å†™helpï¼ŒæŸ¥çœ‹å‘½ä»¤çš„å¸®åŠ©

```arduino
get-help get-process
å¤åˆ¶ä»£ç 
```

##### å…¶ä»–å‘½ä»¤

-   get-date, åˆ«åï¼šdateï¼Œè·å–ç³»ç»Ÿå½“å‰æ—¶é—´
-   Get-Commandï¼Œåˆ«åï¼šgcmï¼Œ æŸ¥æ‰¾æ‰€æœ‰å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡é€šé…ç¬¦æŸ¥æ‰¾ï¼Œå¦‚ï¼šget-command *process
-   write-output, åˆ«åï¼šechoã€ write, æŠŠä¸œè¥¿è¾“å‡ºå‘é€åˆ°ç®¡é“ï¼Œä»é‚£é‡Œå®ƒå¯ä»¥é€šè¿‡ç®¡é“ä¼ è¾“åˆ°å¦ä¸€ä¸ªcmdletæˆ–è€…å˜é‡
-   write-host ç›´æ¥è¾“å‡ºåˆ°æ§åˆ¶å°
-   get-contentï¼Œåˆ«åï¼šcat, è¾“å‡ºæ–‡ä»¶å†…å®¹åˆ°æ§åˆ¶å°
-   Install-Module module-name -Scope CurrentUserï¼Œä»åœ¨çº¿åº“ä¸­æ‰¾åˆ°åŒ…å¹¶å®‰è£…åŒ…åˆ°æœ¬åœ°
-   Import-Module module-nameï¼Œå¯¼å…¥åŒ…
-   chcp, ä¿®æ”¹å½“å‰çš„ç¼–ç æ–¹å¼ï¼Œé»˜è®¤ 936 (GB2312)ï¼Œå¯ä»¥é€šè¿‡`chcp 65001`è®¾ç½®ä¸º UTF-8 æ ¼å¼
